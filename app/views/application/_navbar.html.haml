%header.main-header
  %nav.navbar.navbar-expand-lg
    .container

      / Brand
      %a.navbar-brand{ href: root_url }
        %img{ src: asset_path('main_menu_logo.png'), alt: "Main Menu Logo", width: "125", class: "d-inline-block align-text-top" }

      / Menu Toggler
      %button.navbar-toggler{ type: "button", data: { bs_toggle: "collapse", bs_target: "#navbarSupportedContent" }, aria: { controls: "navbarSupportedContent", expanded: "false", label: "Toggle navigation" } }
        %span.navbar-toggler-icon

      / Main Menu
      #navbarSupportedContent.navbar-collapse.collapse
        %ul.menu-main.navbar-nav.ms-auto.mb-2.mb-lg-0
          - current_page = request.path
          - main_menu.each do |menu_item|
            - active = current_page?(menu_item[:path])

            - if menu_item[:children].present?
              %li.nav-item.dropdown{ class: "#{'active' if active}" }
                %a.nav-link.dropdown-toggle{ href: "#", id: "navbarDropdown", role: "button", data: { bs_toggle: "dropdown" }, aria: { expanded: "false" } }
                  = menu_item[:name]
                %ul.dropdown-menu{ aria_labelledby: "navbarDropdown" }
                  - menu_item[:children].each do |child|
                    - active = current_page == child[:path]
                    %li
                      %a.dropdown-item{ href: child[:path], class: "#{'active' if active}", aria: { current: ("true" if active) } }
                        = child[:name]
            - else
              %li.nav-item.me-2{ class: "#{'active' if active}" }
                %a.nav-link{ href: menu_item[:path], class: "#{'active' if active}", aria: { current: "page" } }
                  = menu_item[:name]