= turbo_frame_tag "results_frame" do

  .mb-4.mt-0
    = render 'searches/advanced/active_filters'

  .input-group.mb-4
    = text_field_tag :q, params[:q], 
      class: 'form-control shadow-none', 
      placeholder: 'Search communities by name...', 
      form: 'filter-form', 
      autocomplete: "off"
    
    %button.btn.btn-aedg-primary{ type: "submit", form: 'filter-form' }
      Search
  -# TODO: fix search 
  .d-flex.justify-content-between.align-items-center.mb-3
    %span.text-muted.fs-5
      - has_filters = params.values.any? { |v| v.is_a?(Array) && v.present? } || params[:q].present?
      = has_filters ? 'Search Results' : 'All Communities'
      %small.ms-2.text-secondary= "#{pluralize(@pagy.count, 'Community')} found"

  - if @communities.any?
    .vstack.gap-3
      - @communities.each do |community|
        = render 'searches/advanced/community_card', community: community
    
    .mt-5.pb-5.d-flex.justify-content-center
      = raw(pagy_bootstrap_nav(@pagy))
  - else
    .text-center.py-5.text-muted
      %i.bi.bi-geo-alt.display-1.mb-3
      %p.fs-4 No communities found matching your filters.