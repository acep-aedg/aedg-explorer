- community = local_assigns.fetch(:community)

.mb-4.border.rounded.overflow-hidden.bg-light-subtle{ style: "transition: all 0.2s;" }
  .p-3
    -# HEADER
    %h5.mb-2.d-flex.align-items-center.flex-wrap
      %i.bi.bi-geo-alt-fill.me-2
      = link_to community.name, community_path(community), class: "text-reset text-decoration-none"
      - if community.grid.present?
        %span.ms-2.text-secondary.fw-semibold.small= "â€¢ #{community.grid.name}"
      - else

    -# BODY
    .mb-3.text-muted.small
      -# -# UTILITIES
      -# - if community.respond_to?(:show_service_areas?) && community.show_service_areas?
      -#   .mb-2
      -#     %i.bi.bi-lightning-charge-fill.me-1
      -#     %strong Utilities:
      -#     - if community.service_areas.count == 1
      -#       = community.service_areas.first.name
      -#     - else
      -#       %ul.list-unstyled.mb-0.ms-3.mt-1
      -#         - community.service_areas.each do |sa|
      -#           %li.mb-1= sa.name

      -# -# POWER PLANTS 
      -# - if community.respond_to?(:show_plants?) && community.show_plants?
      -#   .mb-2
      -#     %i.bi.bi-ev-station-fill.me-1
      -#     %strong Power Plants:
      -#     - if community.plants.size > 3
      -#       %span.fst-italic #{community.plants.size} Plants
      -#     - else
      -#       = community.plants.map(&:name).join(", ")

      - if community.borough.present?
        .mb-1
          %strong= community.borough.census_area? ? "Census Area:" : "Borough:"
          = community.borough.name
      
      - if community.regional_corporation.present?
        .mb-1
          %strong Native Corporation:
          = community.regional_corporation.name

      -# Lighter and with more spacing
      %hr.border-secondary-subtle.my-3
      - if community.respond_to?(:population) && community.population.present?
        .mb-2
          %i.bi.bi-people-fill.me-1
          %strong Population:
          = number_with_delimiter(community.population.total_population)

      - if community.respond_to?(:house_districts) || community.respond_to?(:senate_districts)
        .mb-2
          %i.bi.bi-bank2.me-1
          %strong Leg. Dists:
          - total_count = (community.try(:house_districts)&.count || 0) + (community.try(:senate_districts)&.count || 0)
          
          - if total_count > 4
            %span.fst-italic Multiple Districts
          - else
            - dists = []
            - dists += community.house_districts.map { |d| "HD #{d.district}" } if community.respond_to?(:house_districts)
            - dists += community.senate_districts.map { |d| "SD #{d.district}" } if community.respond_to?(:senate_districts)
            = dists.join(", ")

      -# -# SCHOOL
      -# - if community.respond_to?(:show_school_districts?) && community.show_school_districts?
      -#   .mb-2
      -#     %i.bi.bi-book.me-1
      -#     %strong School:
      -#     - if community.school_districts.count > 1
      -#       = "#{community.school_districts.first.name} (+ #{community.school_districts.count - 1} more)"
      -#     - else
      -#       = community.school_districts.first&.name

    -# TAGS
    .d-flex.flex-wrap
      - if community.try(:pce_active?)
        %span.badge.bg-secondary.me-1.mb-1 PCE Active
      - elsif community.try(:pce_eligible?)
        %span.badge.bg-secondary.me-1.mb-1 PCE Eligible

  -# FOOTER 
  .border-top.px-3.py-2.d-flex.justify-content-end.align-items-center.bg-light
    = link_to community_path(community), class: "btn btn-aedg-primary d-flex align-items-center" do
      View
      %i.bi.bi-arrow-right.ms-1
