- community = local_assigns.fetch(:community)

.mb-4.border.rounded.overflow-hidden.bg-light-subtle
  .p-3
    %h5.mb-2.d-flex.align-items-center.flex-wrap
      %i.bi.bi-people-fill.me-2
      = link_to community.name, community_path(community), class: 'text-dark text-decoration-none'

    / === TAGS AREA ===
    .d-flex.flex-wrap.gap-1
      - if community.respond_to?(:grids)
        - community.grids.active.each do |g|
          = link_to grid_path(g), class: "badge border border-primary text-dark bg-white text-decoration-none" do
            %i.bi.bi-grid-3x3-gap.me-1
            = g.name

      - if (b = community.borough).present?
        %span.badge.bg-secondary.me-1.mb-1.text-capitalize
          = b.name

      - if (rc = community.regional_corporation).present?
        %span.badge.bg-secondary.me-1.mb-1.text-capitalize
          = rc.name

      - if community.respond_to?(:senate_districts)
        - community.senate_districts.each do |d|
          %span.badge.bg-secondary.me-1.mb-1.text-capitalize
            %i.bi.bi-bank.me-1
            = "Senate District #{d.district || d}"

      - if community.respond_to?(:house_districts)
        - community.house_districts.each do |d|
          %span.badge.bg-secondary.me-1.mb-1.text-capitalize
            %i.bi.bi-house.me-1
            - label = d.respond_to?(:name) && d.name.present? ? d.name : "House District #{d.district || d}"
            = label

  .border-top.px-3.py-2.d-flex.justify-content-end.align-items-center
    = link_to community_path(community), class: "btn btn-aedg-primary d-flex align-items-center" do
      View
      %i.bi.bi-arrow-right.ms-2

  - if community.respond_to?(:datasets) && community.datasets.any?
    %h6.mt-3.mb-2 Datasets for this community
    %ul.list-group.list-group-flush
      - community.datasets.limit(3).each do |dataset|
        %li.list-group-item
          = link_to dataset.title, "#"
          %span.text-muted.small.ms-2= dataset.try(:organization)
  - else
    -# no datasets shown
