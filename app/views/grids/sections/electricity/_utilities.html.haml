/ ── Utilities
.d-flex.align-items-center.mb-3
  %i.bi.bi-buildings.me-2.fs-4
  %h4#utilities.mb-0.me-3.py-3.anchor-offset Utilities
  %hr.flex-grow-1.mt-1.mb-0

/ Map
- if @grid.show_utility_map_layers?
  .mb-3.d-none.d-md-block
    %h6.text-uppercase.text-muted.mb-2 View on Map
    .btn-group.btn-group-sm{ role: "group", "aria-label": "Map layers" }
    
      - if @grid.show_service_area_geoms?
        %button.btn.btn-sm.btn-outline-secondary.d-inline-flex.align-items-center.gap-1{
          data: {
            action: "click->maps#showLayer",
            url: service_area_geoms_grid_maps_path(@grid),
            color: "#E74C3C",
            "outline-color": "#943126",
            fit: true,
            checkbox_id: "layer-service-areas"
          }
        }
          %i.bi.bi-bounding-box
          Service Areas

      - if @grid.show_plants?
        %button.btn.btn-sm.btn-outline-secondary.d-inline-flex.align-items-center.gap-1{
          data: {
            action: "click->maps#showLayer",
            url: plants_grid_maps_path(@grid),
            color: "#088",
            fit: true,
            checkbox_id: "layer-plants"        # ensure a matching checkbox exists in the map panel
          }
        }
          %i.bi.bi-building
          Power Plants

/ === Card Body ===
.bg-body-secondary.p-3.rounded.mb-3
  .row.g-4.w-100
    .col
      %p.mb-2
        %i.bi.bi-info-circle-fill.me-2.text-aedg-navy{ data: { controller: 'tooltip', bs_toggle: 'tooltip' }, title: "Utilities in this grid’s service area(s)" }
        %strong Utilities for Service Area(s):
        %ul.mb-2
          - @grid.service_areas.distinct.each do |sa|
            %li.d-flex.align-items-center.mb-1
              %span= sa.name
              - if sa.certificate_url.present?
                = link_to sa.certificate_url, target: "_blank", rel: "noopener", class: "btn btn-sm btn-outline-primary ms-2" do
                  %i.bi.bi-box-arrow-up-right.me-1
                  Certificate
